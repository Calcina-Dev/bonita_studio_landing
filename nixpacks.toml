[variables]
NIXPACKS_PHP_VERSION = "8.4"
NIXPACKS_NODE_VERSION = "20"
NIXPACKS_PHP_EXTENSIONS = "pdo_mysql,pdo_pgsql,bcmath,fileinfo,tokenizer,mbstring,curl,gd,zip,intl"

[phases.build]
cmds = [
    "mkdir -p bootstrap/cache storage/framework/sessions storage/framework/views storage/framework/cache",
    "composer install --no-dev --optimize-autoloader --no-interaction --no-progress",
    "npm install",
    "npm run build"
]

[phases.start]
cmds = [
    
    "php artisan storage:link || true",
    
]
